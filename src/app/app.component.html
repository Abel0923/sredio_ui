<style>
  .loading-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255, 255, 255, 0.7);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10;
  }
  .grid-container {
    padding: 20px;
    text-align: center;
  }

  .grid-title {
    margin-bottom: 10px;
    font-size: 24px;
    font-weight: bold;
  }
</style>
<mat-accordion>
  <mat-expansion-panel (opened)="panelOpenState.set(true)" (closed)="panelOpenState.set(false)">
    <mat-expansion-panel-header>
      <mat-panel-title style="display: flex; justify-content: left;  min-height: 4rem;">
        <img src="/assets/github_icon.png" style="height: 4rem;"/>
        <mat-icon *ngIf="userData">done_all</mat-icon>
      </mat-panel-title>

      <div *ngIf="userData" style="display: flex;">
      <mat-panel-description  style="display: flex; justify-content: center;">
        Welcome {{userData?.displayName}}
      </mat-panel-description>


      <mat-panel-description  style="display: flex; justify-content: center;">
        <span>Last Synced: {{getDate(userData?.connectedAt)}}</span>
        <span>Sync Type: full</span>
      </mat-panel-description>
    </div>
    </mat-expansion-panel-header>

    <div style="display: flex; justify-content: center;">
      <div *ngIf="!userData" style="display: flex; width: 25rem; flex-direction: column; align-items: center; justify-content: center;">
        <button mat-raised-button (click)="connectToGithub()">connect</button>
        <span>{{userData}}</span>
        <span>Connect Sredio to Github</span>
      </div>

      <div *ngIf="userData" style="display: flex; justify-content: flex-end; align-items: end;">
        <button mat-button (click)="removeToGithub()">Remove</button>
      </div>
    </div>

  <div *ngIf="userData" style="display: flex; flex-direction: column; margin-top: 10%; width: 50%;">
    <div style="display: flex; justify-content: space-around;">
      <div style="display: flex; flex-direction: column;">
        <h2 style="font-weight: bolder; color: blueviolet;">Github Projects</h2>
        <mat-form-field>
          <mat-label>Select Organization</mat-label>
          <mat-select [(value)]="selectedOrg" (selectionChange)="getAllOrgRepo($event)">
            <div *ngFor="let item of orgData">
              <mat-option [value]="item.login">{{item?.login}}</mat-option>
            </div>
          </mat-select>
        </mat-form-field>
        <span>Please select organization, you want to connect</span>
      </div>
    </div>
    <div>
      <div *ngIf="loading" class="loading-overlay">
        <p>Loading...</p>
      </div>

      <div class="grid-container" *ngIf="selectedOrg">
        <h1 class="grid-title">{{ selectedOrg + " Repositories"}}</h1>
        <ag-grid-angular
          style="width: 60vw; height: 300px;"
          class="ag-theme-balham grid-no-border"
          [columnDefs]="columnRepoDefs"
          [rowData]="rowRepoData"
          rowSelection="multiple"
          (rowClicked)="getRepoStats($event)"
          [rowMultiSelectWithClick]="false"
          [suppressRowClickSelection]="loading"
          [overlayLoadingTemplate]="'<span>Loading...</span>'"
          [overlayNoRowsTemplate]="'<span>No rows to display</span>'"
          [enableBrowserTooltips]="true">
        </ag-grid-angular>
      </div>

      <div class="grid-container" *ngIf="selectedRepo">
        <h1 class="grid-title">{{ selectedRepo?.name + " Stats"}}</h1>
        <ag-grid-angular
          style="width: 60vw; height: 300px;"
          class="ag-theme-balham grid-no-border"
          [columnDefs]="columnStatsDefs"
          [rowData]="rowStatsData">
        </ag-grid-angular>
      </div>

    </div>

  </div>
  </mat-expansion-panel>
</mat-accordion>


